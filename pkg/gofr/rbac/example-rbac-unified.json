{
  "roleHeader": "X-User-Role",
  "roles": [
    {
      "name": "admin",
      "permissions": ["*:*"],
      "attributes": {
        "department": ["*"],
        "region": ["*"],
        "environment": ["*"]
      }
    },
    {
      "name": "editor",
      "permissions": [
        "users:write",
        "posts:write",
        "comments:read",
        "comments:write"
      ],
      "attributes": {
        "department": ["engineering", "content"],
        "environment": ["production", "staging"]
      },
      "inheritsFrom": ["viewer"]
    },
    {
      "name": "author",
      "permissions": [
        "posts:read",
        "posts:write",
        "comments:read",
        "comments:write"
      ],
      "attributes": {
        "department": ["content"],
        "environment": ["production", "staging", "development"]
      },
      "inheritsFrom": ["viewer"]
    },
    {
      "name": "viewer",
      "permissions": [
        "users:read",
        "posts:read",
        "comments:read"
      ],
      "attributes": {
        "department": ["*"],
        "environment": ["*"]
      }
    }
  ],
  "endpoints": [
    {
      "path": "/health",
      "methods": ["GET"],
      "public": true
    },
    {
      "path": "/metrics",
      "methods": ["GET"],
      "public": true
    },
    {
      "path": "/api/users",
      "methods": ["GET"],
      "requiredPermission": "users:read"
    },
    {
      "path": "/api/users",
      "methods": ["POST"],
      "requiredPermission": "users:write"
    },
    {
      "path": "/api/users/{id}",
      "methods": ["GET"],
      "regex": "^/api/users/\\d+$",
      "requiredPermission": "users:read"
    },
    {
      "path": "/api/users/{id}",
      "methods": ["PUT", "PATCH"],
      "regex": "^/api/users/\\d+$",
      "requiredPermission": "users:write"
    },
    {
      "path": "/api/users/{id}",
      "methods": ["DELETE"],
      "regex": "^/api/users/\\d+$",
      "requiredPermission": "users:delete",
      "allowedRoles": ["admin"]
    },
    {
      "path": "/api/posts",
      "methods": ["GET"],
      "requiredPermission": "posts:read"
    },
    {
      "path": "/api/posts",
      "methods": ["POST"],
      "requiredPermission": "posts:write"
    },
    {
      "path": "/api/posts/{id}",
      "methods": ["GET"],
      "regex": "^/api/posts/\\d+$",
      "requiredPermission": "posts:read"
    },
    {
      "path": "/api/posts/{id}",
      "methods": ["PUT", "PATCH"],
      "regex": "^/api/posts/\\d+$",
      "requiredPermission": "posts:write"
    },
    {
      "path": "/api/posts/{id}",
      "methods": ["DELETE"],
      "regex": "^/api/posts/\\d+$",
      "requiredPermission": "posts:delete"
    },
    {
      "path": "/api/posts/{id}/comments",
      "methods": ["GET"],
      "regex": "^/api/posts/\\d+/comments$",
      "requiredPermission": "comments:read"
    },
    {
      "path": "/api/posts/{id}/comments",
      "methods": ["POST"],
      "regex": "^/api/posts/\\d+/comments$",
      "requiredPermission": "comments:write"
    },
    {
      "path": "/api/admin/*",
      "methods": ["*"],
      "requiredPermission": "admin:*"
    }
  ],
  "defaultRole": "viewer"
}
