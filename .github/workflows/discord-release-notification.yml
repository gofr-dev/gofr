# Discord Release Notification Workflow
# 
# This workflow sends release notes to Discord when a new release is published.
# 
# Setup:
# 1. Create a Discord webhook URL in your Discord server settings
# 2. Add the webhook URL as a secret named "DISCORD_WEBHOOK" in your GitHub repository
#    (Settings -> Secrets and variables -> Actions -> New repository secret)
# 
# Features:
# - Automatically splits long release notes into multiple messages (Discord has a 2000 char limit)
# - Preserves formatting and line breaks
# - Includes release tag, name, and link in the notification

name: Discord Release Notification

on:
  release:
    types: [published]

jobs:
  notify-discord:
    name: Send Release Notes to Discord
    runs-on: ubuntu-latest
    steps:
      - name: Set up Go
        uses: actions/setup-go@v4
        with:
          go-version: '1.21'

      - name: Send Release Notes
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
          RELEASE_TAG: ${{ github.event.release.tag_name }}
          RELEASE_NAME: ${{ github.event.release.name }}
          RELEASE_BODY: ${{ github.event.release.body }}
          RELEASE_URL: ${{ github.event.release.html_url }}
        run: go run .github/workflows/scripts/discord-notifier.go

